import pickle
from dchars.dchars import new_dstring
from dchars.languages.bod.transliterations.ewts import EWTS_BUFFER__FROM_TRANS_STR, \
                                                       EWTS_BUFFER__FROM_STR
DSTRING_BOD_buff = new_dstring(language="བོད་ཡིག",
                               transliteration_method='ewts',
                               options = {"expected structure"  : "Tibetan or Sanskrit",
                                          "use the buffers"     : False,
                                          "fill the buffers"    : True},
                              )

DSTRING_BOD_buff("བོད")

with open("buffering_ewts_words") as src:
    for _word in src.readlines():
        word = _word[:-1]
        DSTRING_BOD_buff().init_from_transliteration(word)

print(len(EWTS_BUFFER__FROM_STR))
print(len(EWTS_BUFFER__FROM_TRANS_STR))
print(len(pickle.dumps(EWTS_BUFFER__FROM_STR)))
print(len(pickle.dumps(EWTS_BUFFER__FROM_TRANS_STR)))

with open("data_str", "wb") as dest:
    dest.write( pickle.dumps(EWTS_BUFFER__FROM_STR) )

with open("data_trans_str", "wb") as dest:
    dest.write( pickle.dumps(EWTS_BUFFER__FROM_TRANS_STR) )
